n = 600
#define polynomial ring in which the initial state variables and the keystream bits exist
R.<s0,s1,s2,s3,s4,s5,s6,s7,s8,s9,s10,s11,s12,s13,s14,y0,y1,y2,y3,y4,y5,y6,y7,y8,y9,y10,y11,y12,y13,y14,y15,y16,y17,y18,y19,y20,y21,y22,y23,y24,y25,y26,y27,y28,y29,y30,y31,y32,y33,y34,y35,y36,y37,y38,y39,y40,y41,y42,y43,y44,y45,y46,y47,y48,y49,y50,y51,y52,y53,y54,y55,y56,y57,y58,y59,y60,y61,y62,y63,y64,y65,y66,y67,y68,y69,y70,y71,y72,y73,y74,y75,y76,y77,y78,y79,y80,y81,y82,y83,y84,y85,y86,y87,y88,y89,y90,y91,y92,y93,y94,y95,y96,y97,y98,y99,y100,y101,y102,y103,y104,y105,y106,y107,y108,y109,y110,y111,y112,y113,y114,y115,y116,y117,y118,y119,y120,y121,y122,y123,y124,y125,y126,y127,y128,y129,y130,y131,y132,y133,y134,y135,y136,y137,y138,y139,y140,y141,y142,y143,y144,y145,y146,y147,y148,y149,y150,y151,y152,y153,y154,y155,y156,y157,y158,y159,y160,y161,y162,y163,y164,y165,y166,y167,y168,y169,y170,y171,y172,y173,y174,y175,y176,y177,y178,y179,y180,y181,y182,y183,y184,y185,y186,y187,y188,y189,y190,y191,y192,y193,y194,y195,y196,y197,y198,y199,y200,y201,y202,y203,y204,y205,y206,y207,y208,y209,y210,y211,y212,y213,y214,y215,y216,y217,y218,y219,y220,y221,y222,y223,y224,y225,y226,y227,y228,y229,y230,y231,y232,y233,y234,y235,y236,y237,y238,y239,y240,y241,y242,y243,y244,y245,y246,y247,y248,y249,y250,y251,y252,y253,y254,y255,y256,y257,y258,y259,y260,y261,y262,y263,y264,y265,y266,y267,y268,y269,y270,y271,y272,y273,y274,y275,y276,y277,y278,y279,y280,y281,y282,y283,y284,y285,y286,y287,y288,y289,y290,y291,y292,y293,y294,y295,y296,y297,y298,y299,y300,y301,y302,y303,y304,y305,y306,y307,y308,y309,y310,y311,y312,y313,y314,y315,y316,y317,y318,y319,y320,y321,y322,y323,y324,y325,y326,y327,y328,y329,y330,y331,y332,y333,y334,y335,y336,y337,y338,y339,y340,y341,y342,y343,y344,y345,y346,y347,y348,y349,y350,y351,y352,y353,y354,y355,y356,y357,y358,y359,y360,y361,y362,y363,y364,y365,y366,y367,y368,y369,y370,y371,y372,y373,y374,y375,y376,y377,y378,y379,y380,y381,y382,y383,y384,y385,y386,y387,y388,y389,y390,y391,y392,y393,y394,y395,y396,y397,y398,y399,y400,y401,y402,y403,y404,y405,y406,y407,y408,y409,y410,y411,y412,y413,y414,y415,y416,y417,y418,y419,y420,y421,y422,y423,y424,y425,y426,y427,y428,y429,y430,y431,y432,y433,y434,y435,y436,y437,y438,y439,y440,y441,y442,y443,y444,y445,y446,y447,y448,y449,y450,y451,y452,y453,y454,y455,y456,y457,y458,y459,y460,y461,y462,y463,y464,y465,y466,y467,y468,y469,y470,y471,y472,y473,y474,y475,y476,y477,y478,y479,y480,y481,y482,y483,y484,y485,y486,y487,y488,y489,y490,y491,y492,y493,y494,y495,y496,y497,y498,y499,y500,y501,y502,y503,y504,y505,y506,y507,y508,y509,y510,y511,y512,y513,y514,y515,y516,y517,y518,y519,y520,y521,y522,y523,y524,y525,y526,y527,y528,y529,y530,y531,y532,y533,y534,y535,y536,y537,y538,y539,y540,y541,y542,y543,y544,y545,y546,y547,y548,y549,y550,y551,y552,y553,y554,y555,y556,y557,y558,y559,y560,y561,y562,y563,y564,y565,y566,y567,y568,y569,y570,y571,y572,y573,y574,y575,y576,y577,y578,y579,y580,y581,y582,y583,y584,y585,y586,y587,y588,y589,y590,y591,y592,y593,y594,y595,y596,y597,y598,y599,y600,y601,y602,y603,y604,y605,y606,y607,y608,y609,y610,y611,y612,y613,y614,y615,y616,y617,y618,y619,y620,y621,y622,y623,y624,y625,y626,y627,y628,y629,y630,y631,y632,y633,y634,y635,y636,y637,y638,y639,y640,y641,y642,y643,y644,y645,y646,y647,y648,y649,y650,y651,y652,y653,y654,y655,y656,y657,y658,y659,y660,y661,y662,y663,y664,y665,y666,y667,y668,y669,y670,y671,y672,y673,y674,y675,y676,y677,y678,y679,y680,y681,y682,y683,y684,y685,y686,y687,y688,y689,y690,y691,y692,y693,y694,y695,y696,y697,y698,y699,y700,y701,y702,y703,y704,y705,y706,y707,y708,y709,y710,y711,y712,y713,y714,y715,y716,y717,y718,y719,y720,y721,y722,y723,y724,y725,y726,y727,y728,y729,y730,y731,y732,y733,y734,y735,y736,y737,y738,y739,y740,y741,y742,y743,y744,y745,y746,y747,y748,y749,y750,y751,y752,y753,y754,y755,y756,y757,y758,y759,y760,y761,y762,y763,y764,y765,y766,y767,y768,y769,y770,y771,y772,y773,y774,y775,y776,y777,y778,y779,y780,y781,y782,y783,y784,y785,y786,y787,y788,y789,y790,y791,y792,y793,y794,y795,y796,y797,y798,y799,y800,y801,y802,y803,y804,y805,y806,y807,y808,y809,y810,y811,y812,y813,y814,y815,y816,y817,y818,y819,y820,y821,y822,y823,y824,y825,y826,y827,y828,y829,y830,y831,y832,y833,y834,y835,y836,y837,y838,y839,y840,y841,y842,y843,y844,y845,y846,y847,y848,y849,y850,y851,y852,y853,y854,y855,y856,y857,y858,y859,y860,y861,y862,y863,y864,y865,y866,y867,y868,y869,y870,y871,y872,y873,y874,y875,y876,y877,y878,y879,y880,y881,y882,y883,y884,y885,y886,y887,y888,y889,y890,y891,y892,y893,y894,y895,y896,y897,y898,y899,y900,y901,y902,y903,y904,y905,y906,y907,y908,y909,y910,y911,y912,y913,y914,y915,y916,y917,y918,y919,y920,y921,y922,y923,y924,y925,y926,y927,y928,y929,y930,y931,y932,y933,y934,y935,y936,y937,y938,y939,y940,y941,y942,y943,y944,y945,y946,y947,y948,y949,y950,y951,y952,y953,y954,y955,y956,y957,y958,y959,y960,y961,y962,y963,y964,y965,y966,y967,y968,y969,y970,y971,y972,y973,y974,y975,y976,y977,y978,y979,y980,y981,y982,y983,y984,y985,y986,y987,y988,y989,y990,y991,y992,y993,y994,y995,y996,y997,y998,y999,u0,u1,u2,u3,u4,u5,u6,u7,u8,u9,u10,u11,u12,u13,u14,u15,u16,u17,u18,u19,u20,u21,u22,u23,u24,u25,u26,u27,u28,u29,u30,u31,u32,u33,u34,u35,u36,u37,u38,u39,u40,u41,u42,u43,u44,u45,u46,u47,u48,u49,u50,u51,u52,u53,u54,u55,u56,u57,u58,u59,u60,u61,u62,u63,u64,u65,u66,u67,u68,u69,u70,u71,u72,u73,u74,u75,u76,u77,u78,u79,u80,u81,u82,u83,u84,u85,u86,u87,u88,u89,u90,u91,u92,u93,u94,u95,u96,u97,u98,u99,u100,u101,u102,u103,u104,u105,u106,u107,u108,u109,u110,u111,u112,u113,u114,u115,u116,u117,u118,u119,u120,u121,u122,u123,u124,u125,u126,u127,u128,u129,u130,u131,u132,u133,u134,u135,u136,u137,u138,u139,u140,u141,u142,u143,u144,u145,u146,u147,u148,u149,u150,u151,u152,u153,u154,u155,u156,u157,u158,u159,u160,u161,u162,u163,u164,u165,u166,u167,u168,u169,u170,u171,u172,u173,u174,u175,u176,u177,u178,u179,u180,u181,u182,u183,u184,u185,u186,u187,u188,u189,u190,u191,u192,u193,u194,u195,u196,u197,u198,u199,u200,u201,u202,u203,u204,u205,u206,u207,u208,u209,u210,u211,u212,u213,u214,u215,u216,u217,u218,u219,u220,u221,u222,u223,u224,u225,u226,u227,u228,u229,u230,u231,u232,u233,u234,u235,u236,u237,u238,u239,u240,u241,u242,u243,u244,u245,u246,u247,u248,u249,u250,u251,u252,u253,u254,u255,u256,u257,u258,u259,u260,u261,u262,u263,u264,u265,u266,u267,u268,u269,u270,u271,u272,u273,u274,u275,u276,u277,u278,u279,u280,u281,u282,u283,u284,u285,u286,u287,u288,u289,u290,u291,u292,u293,u294,u295,u296,u297,u298,u299,u300,u301,u302,u303,u304,u305,u306,u307,u308,u309,u310,u311,u312,u313,u314,u315,u316,u317,u318,u319,u320,u321,u322,u323,u324,u325,u326,u327,u328,u329,u330,u331,u332,u333,u334,u335,u336,u337,u338,u339,u340,u341,u342,u343,u344,u345,u346,u347,u348,u349,u350,u351,u352,u353,u354,u355,u356,u357,u358,u359,u360,u361,u362,u363,u364,u365,u366,u367,u368,u369,u370,u371,u372,u373,u374,u375,u376,u377,u378,u379,u380,u381,u382,u383,u384,u385,u386,u387,u388,u389,u390,u391,u392,u393,u394,u395,u396,u397,u398,u399,u400,u401,u402,u403,u404,u405,u406,u407,u408,u409,u410,u411,u412,u413,u414,u415,u416,u417,u418,u419,u420,u421,u422,u423,u424,u425,u426,u427,u428,u429,u430,u431,u432,u433,u434,u435,u436,u437,u438,u439,u440,u441,u442,u443,u444,u445,u446,u447,u448,u449,u450,u451,u452,u453,u454,u455,u456,u457,u458,u459,u460,u461,u462,u463,u464,u465,u466,u467,u468,u469,u470,u471,u472,u473,u474,u475,u476,u477,u478,u479,u480,u481,u482,u483,u484,u485,u486,u487,u488,u489,u490,u491,u492,u493,u494,u495,u496,u497,u498,u499,u500,u501,u502,u503,u504,u505,u506,u507,u508,u509,u510,u511,u512,u513,u514,u515,u516,u517,u518,u519,u520,u521,u522,u523,u524,u525,u526,u527,u528,u529,u530,u531,u532,u533,u534,u535,u536,u537,u538,u539,u540,u541,u542,u543,u544,u545,u546,u547,u548,u549,u550,u551,u552,u553,u554,u555,u556,u557,u558,u559,u560,u561,u562,u563,u564,u565,u566,u567,u568,u569,u570,u571,u572,u573,u574,u575> = BooleanPolynomialRing(1591)
#R= PolynomialRing(GF(2),1000,var_array=('s','y','u'), order='degrevlex')
#R.inject_variables()
#create a matrix 's' to hold the initial state variables
s =[s0,s1,s2,s3,s4,s5,s6,s7,s8,s9,s10,s11,s12,s13,s14]

#create a matrix to hold all the output variables
Y = [y0,y1,y2,y3,y4,y5,y6,y7,y8,y9,y10,y11,y12,y13,y14,y15,y16,y17,y18,y19,y20,y21,y22,y23,y24,y25,y26,y27,y28,y29,y30,y31,y32,y33,y34,y35,y36,y37,y38,y39,y40,y41,y42,y43,y44,y45,y46,y47,y48,y49,y50,y51,y52,y53,y54,y55,y56,y57,y58,y59,y60,y61,y62,y63,y64,y65,y66,y67,y68,y69,y70,y71,y72,y73,y74,y75,y76,y77,y78,y79,y80,y81,y82,y83,y84,y85,y86,y87,y88,y89,y90,y91,y92,y93,y94,y95,y96,y97,y98,y99,y100,y101,y102,y103,y104,y105,y106,y107,y108,y109,y110,y111,y112,y113,y114,y115,y116,y117,y118,y119,y120,y121,y122,y123,y124,y125,y126,y127,y128,y129,y130,y131,y132,y133,y134,y135,y136,y137,y138,y139,y140,y141,y142,y143,y144,y145,y146,y147,y148,y149,y150,y151,y152,y153,y154,y155,y156,y157,y158,y159,y160,y161,y162,y163,y164,y165,y166,y167,y168,y169,y170,y171,y172,y173,y174,y175,y176,y177,y178,y179,y180,y181,y182,y183,y184,y185,y186,y187,y188,y189,y190,y191,y192,y193,y194,y195,y196,y197,y198,y199,y200,y201,y202,y203,y204,y205,y206,y207,y208,y209,y210,y211,y212,y213,y214,y215,y216,y217,y218,y219,y220,y221,y222,y223,y224,y225,y226,y227,y228,y229,y230,y231,y232,y233,y234,y235,y236,y237,y238,y239,y240,y241,y242,y243,y244,y245,y246,y247,y248,y249,y250,y251,y252,y253,y254,y255,y256,y257,y258,y259,y260,y261,y262,y263,y264,y265,y266,y267,y268,y269,y270,y271,y272,y273,y274,y275,y276,y277,y278,y279,y280,y281,y282,y283,y284,y285,y286,y287,y288,y289,y290,y291,y292,y293,y294,y295,y296,y297,y298,y299,y300,y301,y302,y303,y304,y305,y306,y307,y308,y309,y310,y311,y312,y313,y314,y315,y316,y317,y318,y319,y320,y321,y322,y323,y324,y325,y326,y327,y328,y329,y330,y331,y332,y333,y334,y335,y336,y337,y338,y339,y340,y341,y342,y343,y344,y345,y346,y347,y348,y349,y350,y351,y352,y353,y354,y355,y356,y357,y358,y359,y360,y361,y362,y363,y364,y365,y366,y367,y368,y369,y370,y371,y372,y373,y374,y375,y376,y377,y378,y379,y380,y381,y382,y383,y384,y385,y386,y387,y388,y389,y390,y391,y392,y393,y394,y395,y396,y397,y398,y399,y400,y401,y402,y403,y404,y405,y406,y407,y408,y409,y410,y411,y412,y413,y414,y415,y416,y417,y418,y419,y420,y421,y422,y423,y424,y425,y426,y427,y428,y429,y430,y431,y432,y433,y434,y435,y436,y437,y438,y439,y440,y441,y442,y443,y444,y445,y446,y447,y448,y449,y450,y451,y452,y453,y454,y455,y456,y457,y458,y459,y460,y461,y462,y463,y464,y465,y466,y467,y468,y469,y470,y471,y472,y473,y474,y475,y476,y477,y478,y479,y480,y481,y482,y483,y484,y485,y486,y487,y488,y489,y490,y491,y492,y493,y494,y495,y496,y497,y498,y499,y500,y501,y502,y503,y504,y505,y506,y507,y508,y509,y510,y511,y512,y513,y514,y515,y516,y517,y518,y519,y520,y521,y522,y523,y524,y525,y526,y527,y528,y529,y530,y531,y532,y533,y534,y535,y536,y537,y538,y539,y540,y541,y542,y543,y544,y545,y546,y547,y548,y549,y550,y551,y552,y553,y554,y555,y556,y557,y558,y559,y560,y561,y562,y563,y564,y565,y566,y567,y568,y569,y570,y571,y572,y573,y574,y575,y576,y577,y578,y579,y580,y581,y582,y583,y584,y585,y586,y587,y588,y589,y590,y591,y592,y593,y594,y595,y596,y597,y598,y599,y600,y601,y602,y603,y604,y605,y606,y607,y608,y609,y610,y611,y612,y613,y614,y615,y616,y617,y618,y619,y620,y621,y622,y623,y624,y625,y626,y627,y628,y629,y630,y631,y632,y633,y634,y635,y636,y637,y638,y639,y640,y641,y642,y643,y644,y645,y646,y647,y648,y649,y650,y651,y652,y653,y654,y655,y656,y657,y658,y659,y660,y661,y662,y663,y664,y665,y666,y667,y668,y669,y670,y671,y672,y673,y674,y675,y676,y677,y678,y679,y680,y681,y682,y683,y684,y685,y686,y687,y688,y689,y690,y691,y692,y693,y694,y695,y696,y697,y698,y699,y700,y701,y702,y703,y704,y705,y706,y707,y708,y709,y710,y711,y712,y713,y714,y715,y716,y717,y718,y719,y720,y721,y722,y723,y724,y725,y726,y727,y728,y729,y730,y731,y732,y733,y734,y735,y736,y737,y738,y739,y740,y741,y742,y743,y744,y745,y746,y747,y748,y749,y750,y751,y752,y753,y754,y755,y756,y757,y758,y759,y760,y761,y762,y763,y764,y765,y766,y767,y768,y769,y770,y771,y772,y773,y774,y775,y776,y777,y778,y779,y780,y781,y782,y783,y784,y785,y786,y787,y788,y789,y790,y791,y792,y793,y794,y795,y796,y797,y798,y799,y800,y801,y802,y803,y804,y805,y806,y807,y808,y809,y810,y811,y812,y813,y814,y815,y816,y817,y818,y819,y820,y821,y822,y823,y824,y825,y826,y827,y828,y829,y830,y831,y832,y833,y834,y835,y836,y837,y838,y839,y840,y841,y842,y843,y844,y845,y846,y847,y848,y849,y850,y851,y852,y853,y854,y855,y856,y857,y858,y859,y860,y861,y862,y863,y864,y865,y866,y867,y868,y869,y870,y871,y872,y873,y874,y875,y876,y877,y878,y879,y880,y881,y882,y883,y884,y885,y886,y887,y888,y889,y890,y891,y892,y893,y894,y895,y896,y897,y898,y899,y900,y901,y902,y903,y904,y905,y906,y907,y908,y909,y910,y911,y912,y913,y914,y915,y916,y917,y918,y919,y920,y921,y922,y923,y924,y925,y926,y927,y928,y929,y930,y931,y932,y933,y934,y935,y936,y937,y938,y939,y940,y941,y942,y943,y944,y945,y946,y947,y948,y949,y950,y951,y952,y953,y954,y955,y956,y957,y958,y959,y960,y961,y962,y963,y964,y965,y966,y967,y968,y969,y970,y971,y972,y973,y974,y975,y976,y977,y978,y979,y980,y981,y982,y983,y984,y985,y986,y987,y988,y989,y990,y991,y992,y993,y994,y995,y996,y997,y998,y999]


#We can consider 's' as a register that will be shifted for a specified number of times. Thus, there will exist more entries than simply those defined in 's'.
#We therefore initialise a vector 'add' that will be appended to s to hold all the update bits (one vector for equations with respect to keystream bits S and one with respect the the linear approximation$
add=list(0for i in (1..1000))
S = s+add
G = s+add

#Generate equations for update using output bits
# S[15] = S[0]+S[7]
for i in range(15,n):
     S[i] = (S[i-15]+S[i-8])


#Generate equations for update using linear approximation
for i in range(15,n):
    #(s0s1s2+1)z0+(s0s1s2+1)s9=0
    G[i] = (S[i-15]+1)*Y[i-15]+(S[i-15]+1)*S[i-6]


    # print(i,G[i])
    #create a matrix that will hold the final equations (the sum of those given with respect to the keystream bits + those given by the linear approximation)
EQ = list(var('eq%d' %i) for i in (0..1000))


# Combine both forms of equations
# print(S)
# print(G)
for i in range(15,n):
    EQ[i] = (G[i])

EQ_1=EQ[15:n]

######################################################
#Now substitute in output bits
# S0 = [0,0,1,0,1,1,0,1,0,0,1,1,1,0,0]
# B0 = [1,1,0,0,1,0,1,1,1,0,0,0,1,0,1]

O = [0,1,1,1,0,0,1,0,1,1,0,0,0,1,1,0,0,0,1,0,0,0,1,1,1,0,1,0,1,1,1,1,1,1,1,0,1,0,1,1,1,1,1,1,0,1,1,1,0,1,1,0,0,1,1,0,0,0,0,0,1,0,0,0,1,1,0,0,0,1,0,0,1,1,0,1,0,1,0,1,0,1,0,1,1,1,0,0,1,1,1,1,0,1,1,0,0,1,1,0,1,1,1,1,1,0,1,0,0,1,0,0,0,0,1,1,1,1,0,0,0,1,1,0,1,0,1,0,0,0,0,1,0,0,1,0,1,1,1,1,0,1,1,0,1,0,1,1,0,0,1,1,0,1,0,1,1,1,1,0,1,1,1,1,0,1,0,0,1,0,1,1,0,1,0,1,0,0,1,1,0,1,0,0,1,0,1,1,1,1,1,0,1,1,0,1,1,0,1,1,1,0,1,0,1,0,1,1,0,0,0,0,0,1,0,1,0,1,0,1,0,0,0,1,0,1,0,1,1,0,1,1,1,1,1,1,1,0,0,0,0,1,0,1,1,1,1,0,1,0,1,1,1,1,0,0,0,0,1,1,0,0,0,1,0,1,0,1,1,0,0,1,0,0,0,1,1,0,1,1,1,0,1,0,1,0,0,0,1,0,0,1,1,1,1,0,1,1,0,0,0,1,0,1,1,1,1,1,0,0,0,0,0,0,1,0,1,0,1,1,1,0,0,0,1,0,1,0,0,1,0,1,1,1,0,0,0,1,0,0,1,0,1,0,1,1,1,1,0,0,1,0,0,1,1,0,0,1,1,1,1,0,0,0,0,0,1,1,0,1,0,0,1,1,0,0,0,1,0,0,1,0,1,0,1,1,0,1,0,0,1,0,0,1,0,0,0,1,1,1,1,1,1,0,0,0,0,0,0,0,1,0,1,1,0,0,1,0,1,0,1,0,1,0,0,1,1,1,0,0,1,1,0,0,1,0,0,1,1,1,1,1,0,0,0,0,0,0,1,0,0,0,1,1,1,0,0,0,0,0,1,0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,1,0,1,1,0,0,1,0,1,0,0,1,0,0,1,1,1,1,1,1,0,1,1,1,1,0,1,1,0,0,0,1,0,0,1,1,1,1,0,0,1,0,0,0,1,1,1,0,1,1,1,0,0,0,1,1,1,1,0,1,1,0,0,1,1,0,0,1,0,1,0,1,1,0,1,0,0,0,0,1,1,0,0,0,1,0,1,0,1,1,0,0,1,0,0,1,1,1,0,1,1,1,0,0,0,1,0,0,1,1,1,1,1,1,1,1,0,1,1,0,0,0,0,0,1,0,0,0,1,0,0,0,0,1,1,0,0,1,0,1,0,1,1,1,0,1,0,1,1,0,1,1,1,1,1,1,0,1,0,1,0,1,1,0,0,0,1,0,1,0,1,0,1,0,0,0,0,0,1,0,1,1,0,1,0,1,1,1,1,1,0,1,0,0,1,1,0,1,1,1,1,1,0,1,1,1,1,1,1,0,0,1,0,0,1,0,0,0,1,0,1,0,0,1,0,0,0,0,1,1,0,1,0,1,0,1,1,1,1,1,0,1,0,0,0,1,0,1,1,1,1,1,1,0,1,1,0,1,1,0,0,0,0,0,1,0,1,0,0,1,1,0,0,1,1,0,0,1,1,1,0,1,1,0,1,0,1,1,1,0,1,0,0,1,0,0,0,1,1,1,0,0,1,0,0,0,1,1,1,0,0,0,1,1,0,0,1,1,0,0,1,0,1,0,1,1,0,1,0,0,0,1,0,1,0,0,0,1,0,0,1,1,1,0,0,1,1,0,0,1,1,0,1,1,1,1,1,0,1,0,0,1,0,0,0,1,1,1,1,1,0,0,0,0,1,0,1,0,1,0,1,1,0,1,0,0,1,0,1,0,1,1,0,1,1,1,0,0,1,1,0,0,0,0,0,1,0,1,1,1,0,0,0,0,1,1,0,0,0,0,1,0,0,1,0,0,0,0,1,1,1,1,0,0,0,1,1,0,1,1,0,0,0,0,0,1,1,1,0,0,1,1,1,1,1,1,0,0,1,1,1,1,1,1,0,1,0,0,0,0,1,1,0,0,1,1,1,0,0,1,1,0,1,0,1,1,1,1,1,1,0,0,0,0,0,1,1,0,1,1,0,0,1,1,0,0,1,0,1,0,1,0,0,1,0,0,1,1,0,0,0,0,0,1]
for i in range(len(EQ_1)):
    EQ_1[i]=EQ_1[i].subs(y0=O[0],y1=O[1],y2=O[2],y3=O[3],y4=O[4],y5=O[5],y6=O[6],y7=O[7],y8=O[8],y9=O[9],y10=O[10],y11=O[11],y12=O[12],y13=O[13],y14=O[14],y15=O[15],y16=O[16],y17=O[17],y18=O[18],y19=O[19],y20=O[20],y21=O[21],y22=O[22],y23=O[23],y24=O[24],y25=O[25],y26=O[26],y27=O[27],y28=O[28],y29=O[29],y30=O[30],y31=O[31],y32=O[32],y33=O[33],y34=O[34],y35=O[35],y36=O[36],y37=O[37],y38=O[38],y39=O[39],y40=O[40],y41=O[41],y42=O[42],y43=O[43],y44=O[44],y45=O[45],y46=O[46],y47=O[47],y48=O[48],y49=O[49],y50=O[50],y51=O[51],y52=O[52],y53=O[53],y54=O[54],y55=O[55],y56=O[56],y57=O[57],y58=O[58],y59=O[59],y60=O[60],y61=O[61],y62=O[62],y63=O[63],y64=O[64],y65=O[65],y66=O[66],y67=O[67],y68=O[68],y69=O[69],y70=O[70],y71=O[71],y72=O[72],y73=O[73],y74=O[74],y75=O[75],y76=O[76],y77=O[77],y78=O[78],y79=O[79],y80=O[80],y81=O[81],y82=O[82],y83=O[83],y84=O[84],y85=O[85],y86=O[86],y87=O[87],y88=O[88],y89=O[89],y90=O[90],y91=O[91],y92=O[92],y93=O[93],y94=O[94],y95=O[95],y96=O[96],y97=O[97],y98=O[98],y99=O[99],y100=O[100],y101=O[101],y102=O[102],y103=O[103],y104=O[104],y105=O[105],y106=O[106],y107=O[107],y108=O[108],y109=O[109],y110=O[110],y111=O[111],y112=O[112],y113=O[113],y114=O[114],y115=O[115],y116=O[116],y117=O[117],y118=O[118],y119=O[119],y120=O[120],y121=O[121],y122=O[122],y123=O[123],y124=O[124],y125=O[125],y126=O[126],y127=O[127],y128=O[128],y129=O[129],y130=O[130],y131=O[131],y132=O[132],y133=O[133],y134=O[134],y135=O[135],y136=O[136],y137=O[137],y138=O[138],y139=O[139],y140=O[140],y141=O[141],y142=O[142],y143=O[143],y144=O[144],y145=O[145],y146=O[146],y147=O[147],y148=O[148],y149=O[149],y150=O[150],y151=O[151],y152=O[152],y153=O[153],y154=O[154],y155=O[155],y156=O[156],y157=O[157],y158=O[158],y159=O[159],y160=O[160],y161=O[161],y162=O[162],y163=O[163],y164=O[164],y165=O[165],y166=O[166],y167=O[167],y168=O[168],y169=O[169],y170=O[170],y171=O[171],y172=O[172],y173=O[173],y174=O[174],y175=O[175],y176=O[176],y177=O[177],y178=O[178],y179=O[179],y180=O[180],y181=O[181],y182=O[182],y183=O[183],y184=O[184],y185=O[185],y186=O[186],y187=O[187],y188=O[188],y189=O[189],y190=O[190],y191=O[191],y192=O[192],y193=O[193],y194=O[194],y195=O[195],y196=O[196],y197=O[197],y198=O[198],y199=O[199],y200=O[200],y201=O[201],y202=O[202],y203=O[203],y204=O[204],y205=O[205],y206=O[206],y207=O[207],y208=O[208],y209=O[209],y210=O[210],y211=O[211],y212=O[212],y213=O[213],y214=O[214],y215=O[215],y216=O[216],y217=O[217],y218=O[218],y219=O[219],y220=O[220],y221=O[221],y222=O[222],y223=O[223],y224=O[224],y225=O[225],y226=O[226],y227=O[227],y228=O[228],y229=O[229],y230=O[230],y231=O[231],y232=O[232],y233=O[233],y234=O[234],y235=O[235],y236=O[236],y237=O[237],y238=O[238],y239=O[239],y240=O[240],y241=O[241],y242=O[242],y243=O[243],y244=O[244],y245=O[245],y246=O[246],y247=O[247],y248=O[248],y249=O[249],y250=O[250],y251=O[251],y252=O[252],y253=O[253],y254=O[254],y255=O[255],y256=O[256],y257=O[257],y258=O[258],y259=O[259],y260=O[260],y261=O[261],y262=O[262],y263=O[263],y264=O[264],y265=O[265],y266=O[266],y267=O[267],y268=O[268],y269=O[269],y270=O[270],y271=O[271],y272=O[272],y273=O[273],y274=O[274],y275=O[275],y276=O[276],y277=O[277],y278=O[278],y279=O[279],y280=O[280],y281=O[281],y282=O[282],y283=O[283],y284=O[284],y285=O[285],y286=O[286],y287=O[287],y288=O[288],y289=O[289],y290=O[290],y291=O[291],y292=O[292],y293=O[293],y294=O[294],y295=O[295],y296=O[296],y297=O[297],y298=O[298],y299=O[299],y300=O[300],y301=O[301],y302=O[302],y303=O[303],y304=O[304],y305=O[305],y306=O[306],y307=O[307],y308=O[308],y309=O[309],y310=O[310],y311=O[311],y312=O[312],y313=O[313],y314=O[314],y315=O[315],y316=O[316],y317=O[317],y318=O[318],y319=O[319],y320=O[320],y321=O[321],y322=O[322],y323=O[323],y324=O[324],y325=O[325],y326=O[326],y327=O[327],y328=O[328],y329=O[329],y330=O[330],y331=O[331],y332=O[332],y333=O[333],y334=O[334],y335=O[335],y336=O[336],y337=O[337],y338=O[338],y339=O[339],y340=O[340],y341=O[341],y342=O[342],y343=O[343],y344=O[344],y345=O[345],y346=O[346],y347=O[347],y348=O[348],y349=O[349],y350=O[350],y351=O[351],y352=O[352],y353=O[353],y354=O[354],y355=O[355],y356=O[356],y357=O[357],y358=O[358],y359=O[359],y360=O[360],y361=O[361],y362=O[362],y363=O[363],y364=O[364],y365=O[365],y366=O[366],y367=O[367],y368=O[368],y369=O[369],y370=O[370],y371=O[371],y372=O[372],y373=O[373],y374=O[374],y375=O[375],y376=O[376],y377=O[377],y378=O[378],y379=O[379],y380=O[380],y381=O[381],y382=O[382],y383=O[383],y384=O[384],y385=O[385],y386=O[386],y387=O[387],y388=O[388],y389=O[389],y390=O[390],y391=O[391],y392=O[392],y393=O[393],y394=O[394],y395=O[395],y396=O[396],y397=O[397],y398=O[398],y399=O[399],y400=O[400],y401=O[401],y402=O[402],y403=O[403],y404=O[404],y405=O[405],y406=O[406],y407=O[407],y408=O[408],y409=O[409],y410=O[410],y411=O[411],y412=O[412],y413=O[413],y414=O[414],y415=O[415],y416=O[416],y417=O[417],y418=O[418],y419=O[419],y420=O[420],y421=O[421],y422=O[422],y423=O[423],y424=O[424],y425=O[425],y426=O[426],y427=O[427],y428=O[428],y429=O[429],y430=O[430],y431=O[431],y432=O[432],y433=O[433],y434=O[434],y435=O[435],y436=O[436],y437=O[437],y438=O[438],y439=O[439],y440=O[440],y441=O[441],y442=O[442],y443=O[443],y444=O[444],y445=O[445],y446=O[446],y447=O[447],y448=O[448],y449=O[449],y450=O[450],y451=O[451],y452=O[452],y453=O[453],y454=O[454],y455=O[455],y456=O[456],y457=O[457],y458=O[458],y459=O[459],y460=O[460],y461=O[461],y462=O[462],y463=O[463],y464=O[464],y465=O[465],y466=O[466],y467=O[467],y468=O[468],y469=O[469],y470=O[470],y471=O[471],y472=O[472],y473=O[473],y474=O[474],y475=O[475],y476=O[476],y477=O[477],y478=O[478],y479=O[479],y480=O[480],y481=O[481],y482=O[482],y483=O[483],y484=O[484],y485=O[485],y486=O[486],y487=O[487],y488=O[488],y489=O[489],y490=O[490],y491=O[491],y492=O[492],y493=O[493],y494=O[494],y495=O[495],y496=O[496],y497=O[497],y498=O[498],y499=O[499],y500=O[500],y501=O[501],y502=O[502],y503=O[503],y504=O[504],y505=O[505],y506=O[506],y507=O[507],y508=O[508],y509=O[509],y510=O[510],y511=O[511],y512=O[512],y513=O[513],y514=O[514],y515=O[515],y516=O[516],y517=O[517],y518=O[518],y519=O[519],y520=O[520],y521=O[521],y522=O[522],y523=O[523],y524=O[524],y525=O[525],y526=O[526],y527=O[527],y528=O[528],y529=O[529],y530=O[530],y531=O[531],y532=O[532],y533=O[533],y534=O[534],y535=O[535],y536=O[536],y537=O[537],y538=O[538],y539=O[539],y540=O[540],y541=O[541],y542=O[542],y543=O[543],y544=O[544],y545=O[545],y546=O[546],y547=O[547],y548=O[548],y549=O[549],y550=O[550],y551=O[551],y552=O[552],y553=O[553],y554=O[554],y555=O[555],y556=O[556],y557=O[557],y558=O[558],y559=O[559],y560=O[560],y561=O[561],y562=O[562],y563=O[563],y564=O[564],y565=O[565],y566=O[566],y567=O[567],y568=O[568],y569=O[569],y570=O[570],y571=O[571],y572=O[572],y573=O[573],y574=O[574],y575=O[575],y576=O[576],y577=O[577],y578=O[578],y579=O[579],y580=O[580],y581=O[581],y582=O[582],y583=O[583],y584=O[584],y585=O[585],y586=O[586],y587=O[587],y588=O[588],y589=O[589],y590=O[590],y591=O[591],y592=O[592],y593=O[593],y594=O[594],y595=O[595],y596=O[596],y597=O[597],y598=O[598],y599=O[599],y600=O[600],y601=O[601],y602=O[602],y603=O[603],y604=O[604],y605=O[605],y606=O[606],y607=O[607],y608=O[608],y609=O[609],y610=O[610],y611=O[611],y612=O[612],y613=O[613],y614=O[614],y615=O[615],y616=O[616],y617=O[617],y618=O[618],y619=O[619],y620=O[620],y621=O[621],y622=O[622],y623=O[623],y624=O[624],y625=O[625],y626=O[626],y627=O[627],y628=O[628],y629=O[629],y630=O[630],y631=O[631],y632=O[632],y633=O[633],y634=O[634],y635=O[635],y636=O[636],y637=O[637],y638=O[638],y639=O[639],y640=O[640],y641=O[641],y642=O[642],y643=O[643],y644=O[644],y645=O[645],y646=O[646],y647=O[647],y648=O[648],y649=O[649],y650=O[650],y651=O[651],y652=O[652],y653=O[653],y654=O[654],y655=O[655],y656=O[656],y657=O[657],y658=O[658],y659=O[659],y660=O[660],y661=O[661],y662=O[662],y663=O[663],y664=O[664],y665=O[665],y666=O[666],y667=O[667],y668=O[668],y669=O[669],y670=O[670],y671=O[671],y672=O[672],y673=O[673],y674=O[674],y675=O[675],y676=O[676],y677=O[677],y678=O[678],y679=O[679],y680=O[680],y681=O[681],y682=O[682],y683=O[683],y684=O[684],y685=O[685],y686=O[686],y687=O[687],y688=O[688],y689=O[689],y690=O[690],y691=O[691],y692=O[692],y693=O[693],y694=O[694],y695=O[695],y696=O[696],y697=O[697],y698=O[698],y699=O[699],y700=O[700],y701=O[701],y702=O[702],y703=O[703],y704=O[704],y705=O[705],y706=O[706],y707=O[707],y708=O[708],y709=O[709],y710=O[710],y711=O[711],y712=O[712],y713=O[713],y714=O[714],y715=O[715],y716=O[716],y717=O[717],y718=O[718],y719=O[719],y720=O[720],y721=O[721],y722=O[722],y723=O[723],y724=O[724],y725=O[725],y726=O[726],y727=O[727],y728=O[728],y729=O[729],y730=O[730],y731=O[731],y732=O[732],y733=O[733],y734=O[734],y735=O[735],y736=O[736],y737=O[737],y738=O[738],y739=O[739],y740=O[740],y741=O[741],y742=O[742],y743=O[743],y744=O[744],y745=O[745],y746=O[746],y747=O[747],y748=O[748],y749=O[749],y750=O[750],y751=O[751],y752=O[752],y753=O[753],y754=O[754],y755=O[755],y756=O[756],y757=O[757],y758=O[758],y759=O[759],y760=O[760],y761=O[761],y762=O[762],y763=O[763],y764=O[764],y765=O[765],y766=O[766],y767=O[767],y768=O[768],y769=O[769],y770=O[770],y771=O[771],y772=O[772],y773=O[773],y774=O[774],y775=O[775],y776=O[776],y777=O[777],y778=O[778],y779=O[779],y780=O[780],y781=O[781],y782=O[782],y783=O[783],y784=O[784],y785=O[785],y786=O[786],y787=O[787],y788=O[788],y789=O[789],y790=O[790],y791=O[791],y792=O[792],y793=O[793],y794=O[794],y795=O[795],y796=O[796],y797=O[797],y798=O[798],y799=O[799],y800=O[800],y801=O[801],y802=O[802],y803=O[803],y804=O[804],y805=O[805],y806=O[806],y807=O[807],y808=O[808],y809=O[809],y810=O[810],y811=O[811],y812=O[812],y813=O[813],y814=O[814],y815=O[815],y816=O[816],y817=O[817],y818=O[818],y819=O[819],y820=O[820],y821=O[821],y822=O[822],y823=O[823],y824=O[824],y825=O[825],y826=O[826],y827=O[827],y828=O[828],y829=O[829],y830=O[830],y831=O[831],y832=O[832],y833=O[833],y834=O[834],y835=O[835],y836=O[836],y837=O[837],y838=O[838],y839=O[839],y840=O[840],y841=O[841],y842=O[842],y843=O[843],y844=O[844],y845=O[845],y846=O[846],y847=O[847],y848=O[848],y849=O[849],y850=O[850],y851=O[851],y852=O[852],y853=O[853],y854=O[854],y855=O[855],y856=O[856],y857=O[857],y858=O[858],y859=O[859],y860=O[860],y861=O[861],y862=O[862],y863=O[863],y864=O[864],y865=O[865],y866=O[866],y867=O[867],y868=O[868],y869=O[869],y870=O[870],y871=O[871],y872=O[872],y873=O[873],y874=O[874],y875=O[875],y876=O[876],y877=O[877],y878=O[878],y879=O[879],y880=O[880],y881=O[881],y882=O[882],y883=O[883],y884=O[884],y885=O[885],y886=O[886],y887=O[887],y888=O[888],y889=O[889],y890=O[890],y891=O[891],y892=O[892],y893=O[893],y894=O[894],y895=O[895],y896=O[896],y897=O[897],y898=O[898],y899=O[899],y900=O[900],y901=O[901],y902=O[902],y903=O[903],y904=O[904],y905=O[905],y906=O[906],y907=O[907],y908=O[908],y909=O[909],y910=O[910],y911=O[911],y912=O[912],y913=O[913],y914=O[914],y915=O[915],y916=O[916],y917=O[917],y918=O[918],y919=O[919],y920=O[920],y921=O[921],y922=O[922],y923=O[923],y924=O[924],y925=O[925],y926=O[926],y927=O[927],y928=O[928],y929=O[929],y930=O[930],y931=O[931],y932=O[932],y933=O[933],y934=O[934],y935=O[935],y936=O[936],y937=O[937],y938=O[938],y939=O[939],y940=O[940],y941=O[941],y942=O[942],y943=O[943],y944=O[944],y945=O[945],y946=O[946],y947=O[947],y948=O[948],y949=O[949],y950=O[950],y951=O[951],y952=O[952],y953=O[953],y954=O[954],y955=O[955],y956=O[956],y957=O[957],y958=O[958],y959=O[959],y960=O[960],y961=O[961],y962=O[962],y963=O[963],y964=O[964],y965=O[965],y966=O[966],y967=O[967],y968=O[968],y969=O[969],y970=O[970],y971=O[971],y972=O[972],y973=O[973],y974=O[974],y975=O[975],y976=O[976],y977=O[977],y978=O[978],y979=O[979],y980=O[980],y981=O[981],y982=O[982],y983=O[983],y984=O[984],y985=O[985],y986=O[986],y987=O[987],y988=O[988],y989=O[989],y990=O[990],y991=O[991],y992=O[992],y993=O[993],y994=O[994],y995=O[995],y996=O[996],y997=O[997],y998=O[998],y999=O[999])

############################
#Now linearise

#Define linear substitution variables
U = [u0,u1,u2,u3,u4,u5,u6,u7,u8,u9,u10,u11,u12,u13,u14,u15,u16,u17,u18,u19,u20,u21,u22,u23,u24,u25,u26,u27,u28,u29,u30,u31,u32,u33,u34,u35,u36,u37,u38,u39,u40,u41,u42,u43,u44,u45,u46,u47,u48,u49,u50,u51,u52,u53,u54,u55,u56,u57,u58,u59,u60,u61,u62,u63,u64,u65,u66,u67,u68,u69,u70,u71,u72,u73,u74,u75,u76,u77,u78,u79,u80,u81,u82,u83,u84,u85,u86,u87,u88,u89,u90,u91,u92,u93,u94,u95,u96,u97,u98,u99,u100,u101,u102,u103,u104,u105,u106,u107,u108,u109,u110,u111,u112,u113,u114,u115,u116,u117,u118,u119,u120,u121,u122,u123,u124,u125,u126,u127,u128,u129,u130,u131,u132,u133,u134,u135,u136,u137,u138,u139,u140,u141,u142,u143,u144,u145,u146,u147,u148,u149,u150,u151,u152,u153,u154,u155,u156,u157,u158,u159,u160,u161,u162,u163,u164,u165,u166,u167,u168,u169,u170,u171,u172,u173,u174,u175,u176,u177,u178,u179,u180,u181,u182,u183,u184,u185,u186,u187,u188,u189,u190,u191,u192,u193,u194,u195,u196,u197,u198,u199,u200,u201,u202,u203,u204,u205,u206,u207,u208,u209,u210,u211,u212,u213,u214,u215,u216,u217,u218,u219,u220,u221,u222,u223,u224,u225,u226,u227,u228,u229,u230,u231,u232,u233,u234,u235,u236,u237,u238,u239,u240,u241,u242,u243,u244,u245,u246,u247,u248,u249,u250,u251,u252,u253,u254,u255,u256,u257,u258,u259,u260,u261,u262,u263,u264,u265,u266,u267,u268,u269,u270,u271,u272,u273,u274,u275,u276,u277,u278,u279,u280,u281,u282,u283,u284,u285,u286,u287,u288,u289,u290,u291,u292,u293,u294,u295,u296,u297,u298,u299,u300,u301,u302,u303,u304,u305,u306,u307,u308,u309,u310,u311,u312,u313,u314,u315,u316,u317,u318,u319,u320,u321,u322,u323,u324,u325,u326,u327,u328,u329,u330,u331,u332,u333,u334,u335,u336,u337,u338,u339,u340,u341,u342,u343,u344,u345,u346,u347,u348,u349,u350,u351,u352,u353,u354,u355,u356,u357,u358,u359,u360,u361,u362,u363,u364,u365,u366,u367,u368,u369,u370,u371,u372,u373,u374,u375,u376,u377,u378,u379,u380,u381,u382,u383,u384,u385,u386,u387,u388,u389,u390,u391,u392,u393,u394,u395,u396,u397,u398,u399,u400,u401,u402,u403,u404,u405,u406,u407,u408,u409,u410,u411,u412,u413,u414,u415,u416,u417,u418,u419,u420,u421,u422,u423,u424,u425,u426,u427,u428,u429,u430,u431,u432,u433,u434,u435,u436,u437,u438,u439,u440,u441,u442,u443,u444,u445,u446,u447,u448,u449,u450,u451,u452,u453,u454,u455,u456,u457,u458,u459,u460,u461,u462,u463,u464,u465,u466,u467,u468,u469,u470,u471,u472,u473,u474,u475,u476,u477,u478,u479,u480,u481,u482,u483,u484,u485,u486,u487,u488,u489,u490,u491,u492,u493,u494,u495,u496,u497,u498,u499,u500,u501,u502,u503,u504,u505,u506,u507,u508,u509,u510,u511,u512,u513,u514,u515,u516,u517,u518,u519,u520,u521,u522,u523,u524,u525,u526,u527,u528,u529,u530,u531,u532,u533,u534,u535,u536,u537,u538,u539,u540,u541,u542,u543,u544,u545,u546,u547,u548,u549,u550,u551,u552,u553,u554,u555,u556,u557,u558,u559,u560,u561,u562,u563,u564,u565,u566,u567,u568,u569,u570,u571,u572,u573,u574,u575]

#create monomial list and count the number of combinations
C = Combinations(s)
no = C.cardinality()

#Create each of the monomials
#NOTE: The upper bound in the value of monomials is sum_{k = 0 to d}(n choose k) (number of monomials of degree up to and including d in the n variables)
monomials =[1]*(len(U)+1)
for i in range(len(U)+1):
    for x in C[i]:
        monomials[i]=monomials[i]*x
monomials
#initialise the dictionary
d = {}
#fill the dictionary with the substituion variables
for i in range(1,len(U)+1):
    d[monomials[i]] = U[i-1]
d
EQ_SubWithoutY = [0]*len(EQ_1)
EQ_SubWithY = [0]*len(EQ_1)
EQ_Sub = [0]*len(EQ_1)
#For each equation in the system
for i in range(len(EQ_1)):

    #NOTE:if you sub for the output bits first, you then only need to do the first line of code as there will no longer be output variables
    #make substitution for monomials without output bits
    EQ_Sub[i] = sum(EQ_1[i].monomial_coefficient(m) * v for m,v in d.items())

#     #make substitution for monomials with output bits
#     for j in range(len(W)):
#         EQ_SubWithY[i]= sum(EQ_1[i].monomial_coefficient(m*Y[j]) * v for m,v in d.iteritems())
#         EQ_Sub[i] = EQ_Sub[i]+EQ_SubWithY[i]*Y[j]
#We are interested in the coefficients of the variables
#Initialise coefficient matrix
F = GF(2)
M = matrix(F,len(EQ_Sub),len(U))
#Fill coefficient matrix with 1s in posisitons corresponding to initial
# state bits and odd keystream bits
for j in range(len(EQ_Sub)):
    for i in range(len(U)):
        M[j,i] = EQ_Sub[j].monomial_coefficient(U[i])
w= vector(F,[0]*len(EQ_Sub))

for i in range(len(EQ_Sub)):
    if (EQ_1[i].monomial_coefficient(1)==1):
#    if (EQ_1[i].constant_coefficient()==1):
        w[i]=1
#print(w)
# M
print(M.solve_right(w))
